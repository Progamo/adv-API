#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

protected_branch="main"
current_branch=$(git symbolic-ref HEAD | sed -e 's,.*/\(.*\),\1,')

if [ "$current_branch" = "$protected_branch" ]; then
    echo "Error: NÃ£o Ã© permitido commit diretamente na branch $protected_branch."
    exit 1
fi

echo 'ğŸ—ï¸ğŸ‘· Estilizando, testando e construindo seu projeto antes de se comprometer'

# Check Prettier standards
npm run check-format ||
(
    echo 'ğŸ¤¢ğŸ¤®ğŸ¤¢ğŸ¤® Ã‰ F**KING RAW - Seu estilo parece nojento.. ğŸ¤¢ğŸ¤®ğŸ¤¢ğŸ¤®
            Falha na verificaÃ§Ã£o do Prettier. Execute o npm run lint, adicione alteraÃ§Ãµes e tente confirmar novamente.';
    false;
)

# Linting project
npm run check-lint ||
(
        echo 'ğŸ˜¤ğŸ€ğŸ‘‹ğŸ˜¤ Tire esse fracote daqui! ğŸ˜¤ğŸ€ğŸ‘‹ğŸ˜¤
                  Falha na verificaÃ§Ã£o do ESLint. FaÃ§a as alteraÃ§Ãµes necessÃ¡rias listadas acima, adicione alteraÃ§Ãµes e tente confirmar novamente.'
        false;
)

# Check tsconfig
npm run check-types ||
(
    echo 'ğŸ¤¡ğŸ˜‚âŒğŸ¤¡ VerificaÃ§Ã£o de types com falha. ğŸ¤¡ğŸ˜‚âŒğŸ¤¡
            VocÃª estÃ¡ seriamente tentando escrever isso? FaÃ§a as alteraÃ§Ãµes necessÃ¡rias acima.'
    false;
)

## Check test project
npm run test || (
    echo 'ğŸ¤¢ğŸ¤®ğŸ¤¢ğŸ¤® Ã‰ F**KING RAW - Seu teste parece nojento.. ğŸ¤¢ğŸ¤®ğŸ¤¢ğŸ¤®
    '
    false;
)

## Check build project
npm run build || (
    echo 'ğŸ¤¢ğŸ¤®ğŸ¤¢ğŸ¤® Ã‰ F**KING RAW - Seu teste parece nojento.. ğŸ¤¢ğŸ¤®ğŸ¤¢ğŸ¤®
    '
    false;
)

# If everything passes... Now we can commit
echo '
âœ…âœ…âœ…âœ… VocÃª venceu desta vez... Estou comitando seu codigo agora. âœ…âœ…âœ…âœ…

'
